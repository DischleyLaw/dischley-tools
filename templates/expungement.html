{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">Expungement Petition Form</h2>
  <form method="POST" action="/expungement/generate">
    <div class="mb-3">
      <label for="county" class="form-label">County</label>
      <select class="form-select" id="county" name="county" required onchange="fillProsecutor()">
        <option value="">Select County</option>
        <option value="Fairfax County">Fairfax County</option>
        <option value="Arlington County">Arlington County</option>
        <option value="Prince William County">Prince William County</option>
        <option value="Loudoun County">Loudoun County</option>
        <option value="City of Alexandria">City of Alexandria</option>
        <option value="Stafford County">Stafford County</option>
        <option value="Fauquier County">Fauquier County</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="name" class="form-label">Full Legal Name</label>
      <input type="text" class="form-control" id="name" name="name" required>
    </div>
    <div class="mb-3">
      <label for="dob" class="form-label">Date of Birth</label>
      <input type="date" class="form-control" id="dob" name="dob" required>
    </div>
    <div class="mb-3">
      <label for="name_arrest" class="form-label">Name at Time of Arrest</label>
      <input type="text" class="form-control" id="name_arrest" name="name_arrest">
    </div>
    <div class="mb-3">
      <label for="expungement_type" class="form-label">Type of Expungement</label>
      <select class="form-select" id="expungement_type" name="expungement_type" onchange="toggleManifestInjustice()">
        <option value="">Select Type</option>
        <option value="Expungement of Right">Expungement of Right</option>
        <option value="Manifest Injustice">Manifest Injustice</option>
      </select>
    </div>
    <div class="mb-3" id="manifest_injustice_details_container" style="display: none;">
      <label for="manifest_injustice_details" class="form-label">Manifest Injustice Details</label>
      <textarea class="form-control" id="manifest_injustice_details" name="manifest_injustice_details" rows="4"></textarea>
    </div>
    <hr />
    <h4>Charge Details</h4>
    <div class="mb-3">
      <label for="arrest_date" class="form-label">Date of Arrest</label>
      <input type="date" class="form-control" id="arrest_date" name="arrest_date">
    </div>
    <div class="mb-3">
      <label for="officer_name" class="form-label">Arresting Officer</label>
      <input type="text" class="form-control" id="officer_name" name="officer_name">
    </div>
    <div class="mb-3">
      <label for="police_department" class="form-label">Law Enforcement Agency</label>
      <select class="form-select" id="police_department" name="police_department" required>
        <option value="">Select Agency</option>
        <option value="Fairfax County Police Department">Fairfax County Police Department</option>
        <option value="Arlington County Police Department">Arlington County Police Department</option>
        <option value="Prince William County Police Department">Prince William County Police Department</option>
        <option value="Loudoun County Sheriff's Office">Loudoun County Sheriff's Office</option>
        <option value="Alexandria Police Department">Alexandria Police Department</option>
        <option value="Stafford County Sheriff's Office">Stafford County Sheriff's Office</option>
        <option value="Fauquier County Sheriff's Office">Fauquier County Sheriff's Office</option>
        <option value="Virginia State Police">Virginia State Police</option>
        <option value="Other">Other</option>
      </select>
    </div>
    <div class="mb-3" id="other_police_department_container" style="display: none;">
      <label for="other_police_department" class="form-label">Specify Other Law Enforcement Agency</label>
      <input type="text" class="form-control" id="other_police_department" name="other_police_department">
    </div>
    <div class="mb-3">
      <label for="charge_name" class="form-label">Charge Description</label>
      <input type="text" class="form-control" id="charge_name" name="charge_name">
    </div>
    <div class="mb-3">
      <label for="code_section" class="form-label">Code Section</label>
      <input type="text" class="form-control" id="code_section" name="code_section">
    </div>
    <div class="mb-3">
      <label for="vcc_code" class="form-label">VCC Code</label>
      <input type="text" class="form-control" id="vcc_code" name="vcc_code">
    </div>
    <div class="mb-3">
      <label for="otn" class="form-label">OTN</label>
      <input type="text" class="form-control" id="otn" name="otn">
    </div>
    <div class="mb-3">
      <label for="court_dispo" class="form-label">Court of Final Disposition</label>
      <input type="text" class="form-control" id="court_dispo" name="court_dispo">
    </div>
    <div class="mb-3">
      <label for="case_no" class="form-label">Case Number</label>
      <input type="text" class="form-control" id="case_no" name="case_no">
    </div>
    <div class="mb-3">
      <label for="final_dispo" class="form-label">Final Disposition</label>
      <input type="text" class="form-control" id="final_dispo" name="final_dispo">
    </div>
    <div class="mb-3">
      <label for="dispo_date" class="form-label">Disposition Date</label>
      <input type="date" class="form-control" id="dispo_date" name="dispo_date">
    </div>
    <hr />
    <h4>Prosecutor Info</h4>
    <div class="mb-3">
      <label for="prosecutor" class="form-label">Prosecutor Name</label>
      <input type="text" class="form-control" id="prosecutor" name="prosecutor">
    </div>
    <div class="mb-3">
      <label for="prosecutor_title" class="form-label">Prosecutor Title</label>
      <input type="text" class="form-control" id="prosecutor_title" name="prosecutor_title">
    </div>
    <div class="mb-3">
      <label for="prosecutor_address1" class="form-label">Address Line 1</label>
      <input type="text" class="form-control" id="prosecutor_address1" name="prosecutor_address1">
    </div>
    <div class="mb-3">
      <label for="prosecutor_address2" class="form-label">Address Line 2</label>
      <input type="text" class="form-control" id="prosecutor_address2" name="prosecutor_address2">
    </div>
    <hr />
    <h4>Filing Information</h4>
    <div class="mb-3">
      <label for="month" class="form-label">Month of Petition</label>
      <input type="text" class="form-control" id="month" name="month" value="{{ current_month }}">
    </div>
    <div class="mb-3">
      <label for="year" class="form-label">Year of Petition</label>
      <input type="text" class="form-control" id="year" name="year" value="{{ current_year }}">
    </div>
    <div class="mb-3">
      <label for="attorney" class="form-label">Attorney Name</label>
      <select class="form-select" id="attorney" name="attorney" required>
        <option value="David J. Dischley (VSB No. 73703)">David J. Dischley (VSB No. 73703)</option>
        <option value="Patrick T. O'Brien (VSB No. 81211)">Patrick T. O'Brien (VSB No. 81211)</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary">Generate Petition</button>
    <script>
      const prosecutorData = {
        "Fairfax County": {
          name: "Steve Descano, Esq.",
          title: "Fairfax County Commonwealth's Attorney",
          address1: "4110 Chain Bridge Road",
          address2: "Fairfax, VA 22030"
        },
        "Arlington County": {
          name: "Parisa Tafti, Esq.",
          title: "Arlington County Commonwealth's Attorney",
          address1: "1425 N. Courthouse Rd",
          address2: "Arlington, VA 22201"
        },
        "Prince William County": {
          name: "Amy Ashworth, Esq.",
          title: "Prince William County Commonwealth's Attorney",
          address1: "9311 Lee Ave",
          address2: "Manassas, VA 20110"
        },
        "Loudoun County": {
          name: "Robert Anderson, Esq.",
          title: "Loudoun County Commonwealth's Attorney",
          address1: "20 E Market St",
          address2: "Leesburg, VA 20176"
        },
        "City of Alexandria": {
          name: "Bryan Porter, Esq.",
          title: "Alexandria City Commonwealth's Attorney",
          address1: "520 King Street",
          address2: "Alexandria, VA 22314"
        },
        "Stafford County": {
          name: "Eric Olsen, Esq.",
          title: "Stafford County Commonwealth's Attorney",
          address1: "1245 Courthouse Road",
          address2: "Stafford, VA 22555"
        },
        "Fauquier County": {
          name: "Scott Hook, Esq.",
          title: "Fauquier County Commonwealth's Attorney",
          address1: "29 Ashby Street",
          address2: "Warrenton, VA 20186"
        }
      };

      function fillProsecutor() {
        const county = document.getElementById('county').value;
        const data = prosecutorData[county] || {};
        document.getElementById('prosecutor').value = data.name || '';
        document.getElementById('prosecutor_title').value = data.title || '';
        document.getElementById('prosecutor_address1').value = data.address1 || '';
        document.getElementById('prosecutor_address2').value = data.address2 || '';
      }
    </script>
    <script>
      function toggleManifestInjustice() {
        const type = document.getElementById('expungement_type').value;
        const container = document.getElementById('manifest_injustice_details_container');
        container.style.display = (type === 'Manifest Injustice') ? 'block' : 'none';
      }
    </script>
    <script>
      document.getElementById('police_department').addEventListener('change', function () {
        const otherContainer = document.getElementById('other_police_department_container');
        otherContainer.style.display = this.value === 'Other' ? 'block' : 'none';
      });
    </script>
  </form>
</div>
{% endblock %}