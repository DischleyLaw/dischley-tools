{% extends "base.html" %}
{% block content %}
<div class="intake-card">
  <h2 class="mb-4">Manage Lead</h2>
  <form method="POST" action="{{ url_for('update_lead', lead_id=lead.id) }}">
    <div class="mb-3">
      <label for="name" class="form-label">Name</label>
      <input type="text" name="name" class="form-control" value="{{ lead.name }}">
    </div>
    <div class="mb-3">
      <label for="phone" class="form-label">Phone</label>
      <input type="tel" name="phone" class="form-control" value="{{ lead.phone }}">
    </div>
    <div class="mb-3">
      <label for="email" class="form-label">Email</label>
      <input type="email" name="email" class="form-control" value="{{ lead.email }}">
    </div>
    <div class="mb-3">
      <label for="court" class="form-label">Court</label>
      <input type="text" name="court" class="form-control" value="{{ lead.court }}">
    </div>
    <div class="mb-3">
      <label for="charges" class="form-label">Charges</label>
      <textarea name="charges" class="form-control">{{ lead.charges }}</textarea>
    </div>
    <div class="mb-3">
      <label for="facts" class="form-label">Facts</label>
      <textarea name="facts" class="form-control">{{ lead.facts }}</textarea>
    </div>
    <div class="mb-3">
      <label for="notes" class="form-label">Notes</label>
      <textarea name="notes" class="form-control">{{ lead.notes }}</textarea>
    </div>
    <div class="mb-3">
      <label for="homework" class="form-label">Homework</label>
      <textarea name="homework" class="form-control">{{ lead.homework }}</textarea>
    </div>
    <div class="mb-3">
      <label class="form-label">Additional Homework:</label>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_reckless" id="homework_reckless">
        <label class="form-check-label" for="homework_reckless">Reckless Driving Course</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_aggressive" id="homework_aggressive">
        <label class="form-check-label" for="homework_aggressive">Aggressive Driving Course</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_driver_improvement" id="homework_driver_improvement">
        <label class="form-check-label" for="homework_driver_improvement">Driver Improvement Course</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_community_service" id="homework_community_service">
        <label class="form-check-label" for="homework_community_service">Community Service</label>
      </div>
      <div class="mb-3" id="communityServiceHours" style="display: none;">
        <label for="homework_community_service_hours" class="form-label">Community Service Hours</label>
        <input type="text" class="form-control" name="homework_community_service_hours" id="homework_community_service_hours" placeholder="Enter number of hours">
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_substance_evaluation" id="homework_substance_evaluation">
        <label class="form-check-label" for="homework_substance_evaluation">Substance Abuse Evaluation</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_driving_record" id="homework_driving_record">
        <label class="form-check-label" for="homework_driving_record">Driving Record</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_asap" id="homework_asap">
        <label class="form-check-label" for="homework_asap">Pre-enroll in ASAP</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" name="homework_shoplifting" id="homework_shoplifting">
        <label class="form-check-label" for="homework_shoplifting">Shoplifting Class</label>
      </div>
    </div>
    <div class="mb-3">
      <label for="court_date" class="form-label">Court Date</label>
      <input type="date" name="court_date" class="form-control" value="{{ lead.court_date }}">
    </div>
    <div class="mb-3">
      <label for="court_time" class="form-label">Court Time</label>
      <input type="time" name="court_time" class="form-control" value="{{ lead.court_time }}">
    </div>
    <div class="mb-3 form-floating">
      <select name="staff_member" class="form-select" id="staffMemberSelect">
        <option value="">-- Select Staff Member --</option>
        <option value="Tatum Brownlee" {% if lead.staff_member == "Tatum Brownlee" %}selected{% endif %}>Tatum Brownlee</option>
        <option value="Nicole Purvis" {% if lead.staff_member == "Nicole Purvis" %}selected{% endif %}>Nicole Purvis</option>
        <option value="Patrick O'Brien" {% if lead.staff_member == "Patrick O'Brien" %}selected{% endif %}>Patrick O'Brien</option>
        <option value="David Dischley" {% if lead.staff_member == "David Dischley" %}selected{% endif %}>David Dischley</option>
      </select>
      <label for="staffMemberSelect" class="form-label">Staff Member</label>
    </div>
    <div class="mb-3 form-floating">
      <select name="case_type" id="caseTypeDropdown" class="form-select">
        <option value="">-- Select Case Type --</option>
        <option value="Criminal" {% if lead.case_type == "Criminal" %}selected{% endif %}>Criminal</option>
        <option value="DUI" {% if lead.case_type == "DUI" %}selected{% endif %}>DUI</option>
        <option value="Traffic" {% if lead.case_type == "Traffic" %}selected{% endif %}>Traffic</option>
        <option value="Protective Order" {% if lead.case_type == "Protective Order" %}selected{% endif %}>Protective Order</option>
        <option value="Expungement" {% if lead.case_type == "Expungement" %}selected{% endif %}>Expungement</option>
        <option value="Probation Violation" {% if lead.case_type == "Probation Violation" %}selected{% endif %}>Probation Violation</option>
        <option value="Civil" {% if lead.case_type == "Civil" %}selected{% endif %}>Civil</option>
      </select>
      <label for="caseTypeDropdown" class="form-label">Type of Case</label>
    </div>
    <div class="mb-3 form-floating">
      <select name="attorney" id="attorney" class="form-select">
        <option value="">-- Select Attorney --</option>
        <option value="Patrick O'Brien" {% if lead.attorney == "Patrick O'Brien" %}selected{% endif %}>Patrick O'Brien</option>
        <option value="David Dischley" {% if lead.attorney == "David Dischley" %}selected{% endif %}>David Dischley</option>
      </select>
      <label for="attorney" class="form-label">Attorney</label>
    </div>
    <div class="mb-3">
      <label for="lead_source" class="form-label">Lead Source</label>
      <input type="text" name="lead_source" class="form-control" value="{{ lead.lead_source }}">
    </div>
    <div class="mb-3 form-check">
      <input type="checkbox" name="send_retainer" class="form-check-input" id="sendRetainer" {% if lead.send_retainer %}checked{% endif %}>
      <label class="form-check-label" for="sendRetainer">Send Retainer</label>
    </div>
    <div class="mb-3">
      <label for="retainer_amount" class="form-label">Retainer Amount</label>
      <input type="text" name="retainer_amount" class="form-control" value="{{ lead.retainer_amount or '' }}">
    </div>
    <div class="mb-3 form-check">
      <input type="checkbox" name="lvm" class="form-check-input" id="lvm" {% if lead.lvm %}checked{% endif %}>
      <label class="form-check-label" for="lvm">Left Voicemail</label>
    </div>
    <div class="mb-3 form-check">
      <input type="checkbox" name="not_pc" class="form-check-input" id="notPC" {% if lead.not_pc %}checked{% endif %}>
      <label class="form-check-label" for="notPC">Not a Potential Client</label>
    </div>
    <div class="mb-3">
      <label for="quote" class="form-label">Quoted Amount</label>
      <input type="text" name="quote" class="form-control" value="{{ lead.quote }}">
    </div>
    <button type="submit" class="btn btn-primary">Update Lead</button>
  </form>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const csCheckbox = document.getElementById("homework_community_service");
    const csHours = document.getElementById("communityServiceHours");
    csCheckbox.addEventListener("change", function () {
      csHours.style.display = this.checked ? "block" : "none";
    });
  });
</script>
{% endblock %}